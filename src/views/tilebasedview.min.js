PivotViewer.Views.TileBasedView=PivotViewer.Views.IPivotViewerView.subClass({init:function(){this._super();var n=this;$.subscribe("/PivotViewer/Views/Canvas/Drag",function(t){if(n.isActive){var i=t.x,r=t.y;(i>0&&n.currentOffsetX>n.offsetX?i=0:n.currentOffsetX<n.offsetX&&n.currentWidth==n.width?i=0:i<0&&n.currentOffsetX<-n.currentWidth+n.width?i=0:n.currentOffsetX+=i,r>0&&n.currentOffsetY+n.canvasHeightUIAdjusted>n.currentHeight+n.offsetY?r=0:n.currentOffsetY<n.offsetY&&n.currentHeight==n.height?r=0:r<0&&n.currentOffsetY-n.offsetY<-n.currentHeight+n.height?r=0:n.currentOffsetY+=r,i!=0||r!=0)&&n.offsetTiles(i,r)}})},super_handleClick:function(n){for(var i,t=0;t<this.filterList.length;t++)if(i=this.filterList[t].contains(n.x,n.y),i>=0)return this.filterList[t]},handleClick:function(n){return this.super_handleClick(n)},super_handleHover:function(n){var t,i;if(this.selected==null)for(t=0;t<this.filterList.length;t++)i=this.filterList[t].contains(n.x,n.y),i>=0?this.filterList[t].setSelected(!0):this.filterList[t].setSelected(!1)},handleHover:function(n){this.super_handleHover(n)},activate:function(){this._super();$(".pv-toolbarpanel-zoomslider").fadeIn();$(".pv-toolbarpanel-zoomcontrols").css("border-width","1px");$("#MAIN_BODY").css("overflow","auto");$(".pv-toolbarpanel-sort").fadeIn();$(".pv-canvas").fadeIn()},deactivate:function(){this._super();$(".pv-toolbarpanel-zoomslider").fadeOut();$(".pv-toolbarpanel-sort").fadeOut();$(".pv-canvas").fadeOut()},offsetTiles:function(n,t){for(var i=0;i<this.filterList.length;i++)this.filterList[i]._locations[0].destinationx+=n,this.filterList[i]._locations[0].destinationy+=t},calculateDimensions:function(n,t,i,r){var e=.9,s=i*(r-e*e),o=(t+n*i)*e,l=-1*t*n,u=(-1*o+Math.sqrt(o*o-4*s*l))/(2*s),f=Math.floor(u*i),h=Math.floor(t/f),c=n>u?Math.floor(n/u):1,a=n-c*u,v=t-h*f;return f<3&&(f=3),{Rows:h,Columns:c,TileMaxWidth:u,TileHeight:f,PaddingX:a,PaddingY:v}},getTileDimensions:function(n,t,i,r,u){var f=.9,s=i*(r-f*f),e=(t+n*i)*f,c=-1*t*n,o=(-1*e+Math.sqrt(e*e-4*s*c))/(2*s),h=Math.floor(o*i),l=n-u.Columns*o,a=t-u.Rows*h;return{Rows:u.Rows,Columns:u.Columns,TileMaxWidth:o,TileHeight:h,PaddingX:l,PaddingY:a}}});